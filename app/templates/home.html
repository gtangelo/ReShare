{% extends 'base.html' %} {% block head %}
<title>Feed</title>
{% endblock %} {% block body %}
<h1>Create Post</h1>
<hr />

<form method="POST" action="">
  {{form.hidden_tag()}}
  <fieldset class="form-group">
    <div class="form-group">
      {{form.title.label(class="col-form-label-lg")}} {%if form.title.errors%}
      {{form.title(class="form-control is-invalid")}}
      <div class="invalid-feedback">
        {%for error in form.title.errors%}
        <span>{{error}}</span>
        {%endfor%}
      </div>
      {%else%} {{form.title(class="form-control ")}} {%endif%}
    </div>
    <div class="form-group">
      {{form.content.label(class="col-form-label-lg")}}
      {{form.content(class="form-control", rows="4")}}
    </div>
  </fieldset>
  <div class="form-group">{{form.submit(class="btn btn btn-success")}}</div>
</form>

<br />
<h1>Your Feed</h1>
<hr />

{%if feed%} {% for post in feed%}
<div class="post-container" id="{{post.id}}">
  {%if current_user.is_authenticated%}
  <div class="like-bar">
    {%else%}
    <div class="like-bar-view">
      {%endif%}
      <button class="upvote">Likes: {{post.likes}}</button>
      <button class="devote">Dislikes: {{post.dislikes}}</button>
    </div>
    <div
      id="{{post.id}}"
      style="cursor: pointer"
      onclick="window.location='{{url_for('display_post', id=post.id)}}';"
    >
      <small>Posted by {{post.author}} on </small>
      <small class="publish-date">{{post.date}}</small>
      <h3>{{post.title}}</h3>
      <hr />
      <p style="white-space: pre-wrap">{{post.content}}</p>
      {% if current_user.username == post.author or current_user.username ==
      "admin"%}
      <a
        href="{{url_for('edit_post', id=post.id)}}"
        class="btn btn-primary btn-sm"
        >Edit</a
      >
      &nbsp
      <a
        href="{{url_for('delete_post', id=post.id)}}"
        class="btn btn-danger btn-sm"
        >Delete</a
      >
      {%endif%}
    </div>
  </div>
  <br />
  {%endfor%} {%else%}
  <i> No posts in feed</i>
  <br />
  <br />
  {%endif%} {% endblock %}
</div>
